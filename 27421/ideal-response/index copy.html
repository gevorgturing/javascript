<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CV Maker</title>
<style>
:root {
    --bg-color: white;
    --text-color: black;
    --button-bg: #007BFF;
    --button-text: white;
}

body {
    font-family: Arial, sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    transition: background-color 0.3s, color 0.3s;
}

.container {
    max-width: 800px;
    margin: 20px auto;
    padding: 20px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

input, textarea, button {
    width: 100%;
    padding: 10px;
    margin: 5px 0;
    border: 1px solid #ccc;
    background-color: var(--bg-color);
    color: var(--text-color);
}

button {
    background-color: var(--button-bg);
    color: var(--button-text);
    border: none;
    cursor: pointer;
}

button:hover {
    opacity: 0.9;
}

.dark-mode {
    --bg-color: #333;
    --text-color: #ddd;
    --button-bg: #555;
    --button-text: #fff;
}

#cvPreview {
    display: none;
    border: 1px solid #ccc;
    padding: 20px;
    margin-top: 20px;
}

.photo-preview {
    max-width: 150px;
    max-height: 150px;
    margin: 10px 0;
}
</style>
</head>
<body>
<div class="container" id="container">
    <button onclick="toggleMode()">Toggle Dark/Light Mode</button>
    <form id="cvForm">
        <input type="text" id="firstName" placeholder="First Name" required>
        <input type="text" id="lastName" placeholder="Last Name" required>
        <input type="email" id="email" placeholder="Email">
        <input type="tel" id="phone" placeholder="Phone Number">
        <input type="file" id="photo" accept="image/*">
        <textarea id="summary" placeholder="Professional Summary"></textarea>
        <textarea id="workHistory" placeholder="Work History"></textarea>
        <textarea id="skills" placeholder="Skills"></textarea>
        <textarea id="education" placeholder="Education"></textarea>
        <button type="button" onclick="previewCV()">Preview</button>
        <button type="button" onclick="resetForm()">Reset</button>
        <button type="button" onclick="downloadPDF()">Download PDF</button>
    </form>
    <div id="cvPreview"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
<script>
let isPreview = false;

function updateLocalStorage() {
    localStorage.setItem('cvData', JSON.stringify({
        firstName: document.getElementById('firstName').value,
        lastName: document.getElementById('lastName').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        summary: document.getElementById('summary').value,
        workHistory: document.getElementById('workHistory').value,
        skills: document.getElementById('skills').value,
        education: document.getElementById('education').value
    }));
}

function loadFromLocalStorage() {
    const data = JSON.parse(localStorage.getItem('cvData') || '{}');
    for (let key in data) {
        if (document.getElementById(key)) {
            document.getElementById(key).value = data[key];
        }
    }
}

function toggleMode() {
    document.body.classList.toggle('dark-mode');
}

function previewCV() {
    if (!isPreview) {
        document.getElementById('cvForm').style.display = 'none';
        const preview = document.getElementById('cvPreview');
        preview.style.display = 'block';
        preview.innerHTML = generateCVHTML();
        isPreview = true;
    }
}

function editCV() {
    document.getElementById('cvForm').style.display = 'block';
    document.getElementById('cvPreview').style.display = 'none';
    isPreview = false;
}

function resetForm() {
    if (confirm("Are you sure?")) {
        localStorage.removeItem('cvData');
        document.getElementById('cvForm').reset();
        editCV();
    }
}

function generateCVHTML() {
    const fields = ['firstName', 'lastName', 'email', 'phone', 'summary', 'workHistory', 'skills', 'education'];
    let html = '<h2>' + document.getElementById('firstName').value + ' ' + document.getElementById('lastName').value + '</h2>';
    html += '<p>Email: ' + document.getElementById('email').value + '<br>Phone: ' + document.getElementById('phone').value + '</p>';

    const fileInput = document.getElementById('photo');
    if (fileInput.files.length > 0) {
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('photoPreview').src = e.target.result;
        };
        reader.readAsDataURL(fileInput.files[0]);
        html += '<img id="photoPreview" class="photo-preview" src="" alt="Profile Photo">';
    }

    fields.forEach(field => {
        if (field !== 'firstName' && field !== 'lastName') {
            const value = document.getElementById(field).value;
            if (value) html += '<h3>' + field.charAt(0).toUpperCase() + field.slice(1) + '</h3><p>' + value.replace(/\n/g, '<br>') + '</p>';
        }
    });
    html += '<button onclick="editCV()">Edit</button>';
    return html;
}



document.getElementById('cvForm').addEventListener('input', updateLocalStorage);
loadFromLocalStorage();

function downloadPDF() {
            const content = document.getElementById('container');

            html2canvas(content).then(canvas => {
                // Initialize jsPDF
                const doc = new jspdf.jsPDF({
                    orientation: 'portrait',
                    unit: 'px',
                    format: [canvas.width, canvas.height]
                });

                // Add image (Canvas)
                doc.addImage(canvas.toDataURL('image/png'), 'PNG', 0, 0, canvas.width, canvas.height);

                // Save the PDF
                doc.save('downloaded-content.pdf');
            }).catch(error => {
                console.error('Error in HTML to Canvas conversion:', error);
            });
        }
</script>
</body>
</html>

